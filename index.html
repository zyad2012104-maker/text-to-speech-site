<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <title>تحويل النص إلى صوت (VoiceRSS)</title>
  <!-- GOOGLE ADSENSE CODE HERE -->
  <style>
    body{font-family:sans-serif;max-width:700px;margin:30px auto;padding:10px;}
    textarea{width:100%;height:120px;padding:8px;}
    button{padding:10px 20px;margin-top:10px;background:#28a745;color:#fff;border:none;border-radius:6px;cursor:pointer}
    select,input{margin-top:10px;padding:5px;}
  </style>
</head>
<body>
  <h2>تحويل النص إلى صوت (MP3 قابل للتحميل)</h2>
  <textarea id="txt" placeholder="أدخل النص هنا..."></textarea>
  <div>
    <label>اللغة:</label>
    <select id="lang">
      <option value="ar-eg">العربية (مصر)</option>
      <option value="en-us">English (US)</option>
      <option value="fr-fr">Français</option>
      <option value="de-de">Deutsch</option>
    </select>
  </div>
  <div>
    <label for="voice">اختر الصوت:</label>
<select id="voice">
  <option value="Hossam">رجل</option>
  <option value="Salma">امرأة</option>
</select>

  </div>
  <button id="download">🔊 توليد وتحميل MP3</button>

  <audio id="player" controls style="width:100%;margin-top:15px"></audio>

<script>
document.getElementById('download').onclick = async () => {
  const text = document.getElementById('txt').value.trim();
  if(!text) return alert('أدخل نصاً أولاً');
  const hl   = document.getElementById('lang').value;
  const v    = document.getElementById('voice').value.trim();
  const resp = await fetch('/.netlify/functions/tts-voicerss', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ text, hl, v })
  });
  if(!resp.ok){ alert('حدث خطأ في التوليد'); return; }
  const blob = await resp.blob();
  const url  = URL.createObjectURL(blob);
  // تشغيل الصوت
  document.getElementById('player').src = url;
  // تنزيل الملف
  const a = document.createElement('a');
  a.href = url; a.download = 'speech.mp3';
  a.click();
  URL.revokeObjectURL(url);
};
</script>
</body>
</html>
