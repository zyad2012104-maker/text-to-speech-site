<!doctype html>
<html lang="ar">
<head> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8584077826935053"
     crossorigin="anonymous"></script> <head>
  
  <meta charset="utf-8">
  <title>ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª (VoiceRSS)</title>
  <!-- GOOGLE ADSENSE CODE HERE -->
  <style>
    body{font-family:sans-serif;max-width:700px;margin:30px auto;padding:10px;}
    textarea{width:100%;height:120px;padding:8px;}
    button{padding:10px 20px;margin-top:10px;background:#28a745;color:#fff;border:none;border-radius:6px;cursor:pointer}
    select,input{margin-top:10px;padding:5px;}
  </style>
</head>
<body>
  <h2>ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª (MP3 Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ­Ù…ÙŠÙ„)</h2>
  <textarea id="txt" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§..."></textarea>
  <div>
    <label>Ø§Ù„Ù„ØºØ©:</label>
    <select id="lang">
      <option value="ar-eg">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ù…ØµØ±)</option>
      <option value="en-us">English (US)</option>
      <option value="fr-fr">FranÃ§ais</option>
      <option value="de-de">Deutsch</option>
    </select>
  </div>
  <div>
    <label for="voice">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØª:</label>
<select id="voice">
  <option value="Hossam">Ø±Ø¬Ù„</option>
  <option value="Salma">Ø§Ù…Ø±Ø£Ø©</option>
</select>

 </div>
  <button id="download">ğŸ”Š ØªÙˆÙ„ÙŠØ¯ ÙˆØªØ­Ù…ÙŠÙ„ MP3</button>

  <audio id="player" controls style="width:100%;margin-top:15px"></audio>

<script>
document.getElementById('download').onclick = async () => {
  const text = document.getElementById('txt').value.trim();
  if (!text) return alert('Ø£Ø¯Ø®Ù„ Ù†ØµØ§Ù‹ Ø£ÙˆÙ„Ø§Ù‹');

  const hl    = document.getElementById('lang').value;
  const voice = document.getElementById('voice').value.trim();

  // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ù€ Function Ù…Ù† Netlify
  const resp = await fetch('/.netlify/functions/tts-voicerss', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ text, hl, v: voice })
  });

  if (!resp.ok) { 
    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯'); 
    return; 
  }

  // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥Ù„Ù‰ Blob (Ù…Ù„Ù ØµÙˆØª)
  const blob = await resp.blob();
  const url  = URL.createObjectURL(blob);

  // âœ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ÙÙŠ Ø§Ù„Ù…Ø´ØºÙ„
  const player = document.getElementById('player');
  player.style.display = 'block';  // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª
  player.src = url;                // Ø±Ø¨Ø· Ù…Ù„Ù Ø§Ù„ØµÙˆØª Ø¨Ø§Ù„Ù…Ø´ØºÙ„
  player.play();                   // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ù…Ø¨Ø§Ø´Ø±Ø©

  // âœ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
  const a = document.createElement('a');
  a.href = url;
  a.download = 'speech.mp3';
  a.click();

  // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø©
  URL.revokeObjectURL(url);
};
</script>
</body>
</html>
